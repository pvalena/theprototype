#!/usr/bin/stapÂ·

global fn_calls;

probe ruby.cmethod.entry
{
        fn_calls[classname, methodname] <<< 1;
}

probe end {
        foreach ([classname, methodname] in fn_calls- limit 30) {
                printf("%dx %s.%s\n",
                                @count(fn_calls[classname, methodname]),
                                classname, methodname);
        }

        delete fn_calls;
}

